import{_ as E}from"./D01jHPX4.js";import{r as c,B as L,c as d,o as u,a as e,x as v,y as C,E as b,C as q,F as V,m as $,t as i,g as T,D as I,G as O,k as R,b as z,A as F,w as G,d as j}from"./CSPX8tqz.js";const H={class:"bg-white rounded-lg shadow p-6 mb-6"},J={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},W=["value"],X={__name:"UserFilters",props:{departments:{type:Array,default:()=>[]},initialFilters:{type:Object,default:()=>({full_name:"",personnel_number:"",national_code:"",phone:"",role:"",department_id:""})}},emits:["search","clear"],setup(B,{emit:h}){const y=B,m=h,a=c({...y.initialFilters});L(()=>y.initialFilters,n=>{a.value={...n}},{deep:!0});const p=()=>{m("search",{...a.value})},g=()=>{a.value={full_name:"",personnel_number:"",national_code:"",phone:"",role:"",department_id:""},m("clear")};return(n,t)=>(u(),d("div",H,[e("div",J,[e("div",null,[t[6]||(t[6]=e("label",{for:"full_name",class:"block text-sm font-medium text-gray-700 mb-1"},"نام و نام خانوادگی",-1)),v(e("input",{id:"full_name","onUpdate:modelValue":t[0]||(t[0]=r=>a.value.full_name=r),type:"text",class:"block w-full px-4 py-2.5 text-gray-700 bg-white border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-colors",placeholder:"نام و نام خانوادگی را وارد کنید",onKeyup:b(p,["enter"])},null,544),[[C,a.value.full_name]])]),e("div",null,[t[7]||(t[7]=e("label",{for:"personnel_number",class:"block text-sm font-medium text-gray-700 mb-1"},"شماره پرسنلی",-1)),v(e("input",{id:"personnel_number","onUpdate:modelValue":t[1]||(t[1]=r=>a.value.personnel_number=r),type:"text",class:"block w-full px-4 py-2.5 text-gray-700 bg-white border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-colors",onKeyup:b(p,["enter"])},null,544),[[C,a.value.personnel_number]])]),e("div",null,[t[8]||(t[8]=e("label",{for:"national_code",class:"block text-sm font-medium text-gray-700 mb-1"},"کد ملی",-1)),v(e("input",{id:"national_code","onUpdate:modelValue":t[2]||(t[2]=r=>a.value.national_code=r),type:"text",class:"block w-full px-4 py-2.5 text-gray-700 bg-white border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-colors",onKeyup:b(p,["enter"])},null,544),[[C,a.value.national_code]])]),e("div",null,[t[9]||(t[9]=e("label",{for:"phone",class:"block text-sm font-medium text-gray-700 mb-1"},"شماره موبایل",-1)),v(e("input",{id:"phone","onUpdate:modelValue":t[3]||(t[3]=r=>a.value.phone=r),type:"text",class:"block w-full px-4 py-2.5 text-gray-700 bg-white border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-colors",onKeyup:b(p,["enter"])},null,544),[[C,a.value.phone]])]),e("div",null,[t[11]||(t[11]=e("label",{for:"role",class:"block text-sm font-medium text-gray-700 mb-1"},"نقش",-1)),v(e("select",{id:"role","onUpdate:modelValue":t[4]||(t[4]=r=>a.value.role=r),class:"block w-full px-4 py-2.5 text-gray-700 bg-white border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-colors",onKeyup:b(p,["enter"])},t[10]||(t[10]=[e("option",{value:""},"همه",-1),e("option",{value:"admin"},"مدیر",-1),e("option",{value:"employee"},"کارمند",-1)]),544),[[q,a.value.role]])]),e("div",null,[t[13]||(t[13]=e("label",{for:"department_id",class:"block text-sm font-medium text-gray-700 mb-1"},"دپارتمان",-1)),v(e("select",{id:"department_id","onUpdate:modelValue":t[5]||(t[5]=r=>a.value.department_id=r),class:"block w-full px-4 py-2.5 text-gray-700 bg-white border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-colors",onKeyup:b(p,["enter"])},[t[12]||(t[12]=e("option",{value:""},"همه",-1)),(u(!0),d(V,null,$(B.departments,r=>(u(),d("option",{key:r.id,value:r.id},i(r.title),9,W))),128))],544),[[q,a.value.department_id]])]),e("div",{class:"flex items-end space-x-4 space-x"},[e("button",{onClick:p,class:"flex-1 bg-purple-600 text-white px-4 py-2.5 rounded-lg hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 transition-colors"}," جستجو "),e("button",{onClick:g,class:"flex-1 bg-gray-100 text-gray-700 px-4 py-2.5 rounded-lg hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-colors"}," پاک کردن ")])])]))}},Y={class:"p-0"},Z={class:"bg-white rounded-lg shadow p-6"},Q={key:0,class:"flex justify-center items-center py-8"},ee={key:1,class:"text-red-600 text-center py-8"},te={key:2},se={class:"overflow-x-auto"},le={class:"min-w-full divide-y divide-gray-200"},oe={class:"bg-white divide-y divide-gray-200"},ne={class:"px-6 py-4 whitespace-nowrap"},re={class:"flex items-center"},ae={class:"h-10 w-10 rounded-full overflow-hidden bg-gray-100"},ie=["src","alt"],de={key:1,class:"h-full w-full flex items-center justify-center bg-gray-200"},ue={class:"text-gray-500 text-lg"},pe={class:"px-6 py-4 whitespace-nowrap"},ce={class:"text-sm text-gray-900"},me={class:"px-6 py-4 whitespace-nowrap"},ge={class:"text-sm text-gray-900"},xe={class:"px-6 py-4 whitespace-nowrap"},fe={class:"text-sm text-gray-900"},ve={class:"px-6 py-4 whitespace-nowrap"},be={class:"px-6 py-4 whitespace-nowrap"},ye={class:"text-sm text-gray-900"},_e={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},he={class:"mt-4 flex items-center justify-between"},we={class:"flex-1 flex justify-between sm:hidden"},ke=["disabled"],Ce=["disabled"],je={class:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between"},Be={class:"text-sm text-gray-700"},Me={class:"font-medium"},Ve={class:"font-medium"},$e={class:"font-medium"},Pe={class:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination"},Ue=["disabled"],Ke=["onClick"],qe=["disabled"],Le={__name:"list",setup(B){const{$api:h}=T(),y=I(),m=O(),a=c([]),p=c(!0),g=c(null),n=c(1),t=c(10),r=c(0),_=c(0),P=c([]),x=c({full_name:"",personnel_number:"",national_code:"",phone:"",role:"",department_id:""}),w=async()=>{try{p.value=!0,g.value=null;const s=await h.get("/api/v1/admin/users",{page:n.value,limit:t.value,...x.value});a.value=s.data.users,r.value=s.data.total,_.value=Math.ceil(r.value/t.value)}catch(s){g.value=s.message}finally{p.value=!1}},N=async()=>{try{const s=await h.get("/api/v1/departments");P.value=s.data.departments||[]}catch(s){console.error("Error fetching departments:",s)}},M=s=>{n.value=s,m.push({query:{...y.query,page:s,...x.value}}),w()},S=s=>{x.value={...s},n.value=1;const l=Object.entries(s).reduce((k,[o,f])=>(f!==""&&(k[o]=f),k),{page:1,_fromButton:!0});m.push({query:l}),w()},D=()=>{x.value={full_name:"",personnel_number:"",national_code:"",phone:"",role:"",department_id:""},n.value=1,m.push({query:{page:1,_fromButton:!0}}),w()},U=()=>{n.value<_.value&&M(n.value+1)},K=()=>{n.value>1&&M(n.value-1)},A=s=>{M(s)};return L(()=>y.query,s=>{x.value={full_name:s.full_name||"",personnel_number:s.personnel_number||"",national_code:s.national_code||"",phone:s.phone||"",role:s.role||"",department_id:s.department_id||""};const l=parseInt(s.page)||1;l!==n.value&&(n.value=l),w()},{immediate:!0,deep:!0}),R(()=>{N()}),(s,l)=>{const k=E;return u(),d("div",Y,[l[9]||(l[9]=e("h1",{class:"text-xl font-bold text-purple-700 mb-6"},"مدیریت کاربران",-1)),z(X,{departments:P.value,"initial-filters":x.value,onSearch:S,onClear:D},null,8,["departments","initial-filters"]),e("div",Z,[p.value?(u(),d("div",Q,l[0]||(l[0]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600"},null,-1)]))):g.value?(u(),d("div",ee,i(g.value),1)):(u(),d("div",te,[e("div",se,[e("table",le,[l[2]||(l[2]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," آواتار "),e("th",{scope:"col",class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," نام و نام خانوادگی "),e("th",{scope:"col",class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," ایمیل "),e("th",{scope:"col",class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," شماره موبایل "),e("th",{scope:"col",class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," نقش "),e("th",{scope:"col",class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," دپارتمان "),e("th",{scope:"col",class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," عملیات ")])],-1)),e("tbody",oe,[(u(!0),d(V,null,$(a.value,o=>{var f;return u(),d("tr",{key:o.id},[e("td",ne,[e("div",re,[e("div",ae,[o.avatar?(u(),d("img",{key:0,src:o.avatar,alt:`${o.first_name} ${o.last_name}`,class:"h-full w-full object-cover"},null,8,ie)):(u(),d("div",de,[e("span",ue,i(o.first_name[0])+i(o.last_name[0]),1)]))])])]),e("td",pe,[e("div",ce,i(o.first_name)+" "+i(o.last_name),1)]),e("td",me,[e("div",ge,i(o.email),1)]),e("td",xe,[e("div",fe,i(o.phone),1)]),e("td",ve,[e("span",{class:F(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",o.role==="admin"?"bg-purple-100 text-purple-800":"bg-blue-100 text-blue-800"])},i(o.role==="admin"?"مدیر":"کارمند"),3)]),e("td",be,[e("div",ye,i(((f=o.department)==null?void 0:f.title)||"-"),1)]),e("td",_e,[z(k,{to:`/users/${o.id}`},{default:G(()=>l[1]||(l[1]=[e("button",{class:"text-purple-600 hover:text-purple-900"},[e("div",{class:"inline-flex items-center justify-center w-8 h-8 rounded-full bg-gray-100"},[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor","stroke-width":"2",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.232 5.232l3.536 3.536M9 13l6.586-6.586a2 2 0 112.828 2.828L11.828 15.828a2 2 0 01-2.828 0L9 13zm-6 6h12"})])])],-1)])),_:2},1032,["to"])])])}),128))])])])]))]),e("div",he,[e("div",we,[e("button",{disabled:n.value===1,class:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",onClick:K}," قبلی ",8,ke),e("button",{disabled:n.value===_.value,class:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",onClick:U}," بعدی ",8,Ce)]),e("div",je,[e("div",null,[e("p",Be,[l[3]||(l[3]=j(" نمایش ")),e("span",Me,i((n.value-1)*t.value+1),1),l[4]||(l[4]=j(" تا ")),e("span",Ve,i(Math.min(n.value*t.value,r.value)),1),l[5]||(l[5]=j(" از ")),e("span",$e,i(r.value),1),l[6]||(l[6]=j(" نتیجه "))])]),e("div",null,[e("nav",Pe,[e("button",{disabled:n.value===1,class:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",onClick:K},l[7]||(l[7]=[e("span",{class:"sr-only"},"قبلی",-1),e("svg",{class:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[e("path",{"fill-rule":"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule":"evenodd"})],-1)]),8,Ue),(u(!0),d(V,null,$(_.value,o=>(u(),d("button",{key:o,class:F(["relative inline-flex items-center px-4 py-2 border text-sm font-medium",o===n.value?"z-10 bg-purple-50 border-purple-500 text-purple-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"]),onClick:f=>A(o)},i(o),11,Ke))),128)),e("button",{disabled:n.value===_.value,class:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",onClick:U},l[8]||(l[8]=[e("span",{class:"sr-only"},"بعدی",-1),e("svg",{class:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[e("path",{"fill-rule":"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z","clip-rule":"evenodd"})],-1)]),8,qe)])])])])])}}};export{Le as default};
