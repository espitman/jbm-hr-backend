import{g as w,q as V,r as i,c as r,o as l,l as p,v,a as u,p as B,t as C}from"./CSPX8tqz.js";const G={class:"space-y-4"},I={key:1,class:"flex justify-center items-center py-12"},L={key:2,class:"mt-4"},N=["src"],S={key:3,class:"text-red-600 text-sm text-center bg-red-50 py-2 px-4 rounded-lg"},F={__name:"ImageUpload",props:{dir:{type:String,required:!0}},emits:["uploaded"],setup(m,{emit:g}){const{$api:f}=w(),x=V(),d=i(null),o=i(null),s=i(null),a=i(!1),h=g,y=m,k=()=>{d.value.click()},b=t=>{const e=t.target.files[0];e&&c(e)},_=t=>{const e=t.dataTransfer.files[0];e&&c(e)},c=async t=>{var e;if(s.value=null,o.value=null,a.value=!0,!t.type.startsWith("image/")&&!t.name.endsWith(".svg")){s.value="لطفا یک فایل تصویر یا SVG انتخاب کنید",a.value=!1;return}if(t.size>10*1024*1024){s.value="حجم فایل نباید بیشتر از 10 مگابایت باشد",a.value=!1;return}o.value=URL.createObjectURL(t);try{const n=await f.upload(`/api/v1/upload/image/public/${y.dir}`,t);if((e=n.data)!=null&&e.url)h("uploaded",n.data.url);else throw new Error("خطا در آپلود تصویر")}catch(n){s.value=n.message||"خطا در آپلود تصویر",x.error("خطا در آپلود تصویر")}finally{a.value=!1}};return(t,e)=>(l(),r("div",G,[a.value?(l(),r("div",I,e[2]||(e[2]=[u("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"},null,-1)]))):(l(),r("div",{key:0,class:"relative border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-purple-500 transition-colors",onDragover:e[0]||(e[0]=v(()=>{},["prevent"])),onDrop:v(_,["prevent"]),onClick:k},[u("input",{ref_key:"fileInput",ref:d,type:"file",class:"hidden",accept:"image/*,.svg",onChange:b},null,544),e[1]||(e[1]=B('<div class="space-y-2"><svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg><div class="flex flex-col items-center text-sm text-gray-600"><label class="relative cursor-pointer rounded-md font-medium text-purple-600 hover:text-purple-500"><span>آپلود تصویر</span></label><p class="mt-1">یا فایل را بکشید و رها کنید</p></div><p class="text-xs text-gray-500 text-center">PNG, JPG, GIF, SVG تا 10MB</p></div>',1))],32)),o.value?(l(),r("div",L,[u("img",{src:o.value,class:"max-h-48 rounded-lg mx-auto",alt:"Preview"},null,8,N)])):p("",!0),s.value?(l(),r("div",S,C(s.value),1)):p("",!0)]))}};export{F as _};
