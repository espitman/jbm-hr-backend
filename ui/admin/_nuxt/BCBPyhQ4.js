import{j as _,k as Y,r as d,q as V,c as s,o as a,a as t,m as D,y as M,n,v as p,B as g,F as h,C as j,t as c,b as v,x as y}from"./FE44vmqp.js";import{D as x}from"./BdlHV4-s.js";const U={class:"p-1"},q={class:"bg-white rounded-lg shadow p-6"},B={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},N={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},S=["value"],C={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},F={class:"pt-2"},T=["disabled"],A={key:0,class:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"},E={key:1},L={key:0,class:"text-red-600 text-sm text-center bg-red-50 py-2 px-4 rounded-lg"},G={__name:"register",setup(P){const{$api:f}=_(),m=Y(),r=d({email:"",phone:"",role:"employee",first_name:"",last_name:"",department_id:"",birthdate:"",cooperation_start_date:""}),b=d([]),l=d(!1),i=d(null),w=async()=>{try{l.value=!0;const u=await f.get("/api/v1/departments");b.value=u.data.departments||[]}catch{m.error("خطا در دریافت لیست دپارتمان‌ها")}finally{l.value=!1}},k=async()=>{try{l.value=!0,i.value=null,await f.post("/api/v1/admin/users/register",r.value),r.value={email:"",phone:"",role:"employee",first_name:"",last_name:"",department_id:"",birthdate:"",cooperation_start_date:""},m.success("کاربر با موفقیت ثبت شد")}catch(u){i.value=u.message||"خطا در ثبت کاربر",m.error(i.value)}finally{l.value=!1}};return V(()=>{w()}),(u,e)=>(a(),s("div",U,[e[18]||(e[18]=t("h1",{class:"text-xl font-bold text-purple-700 mb-6"},"ثبت کاربر جدید",-1)),t("div",q,[t("form",{class:"space-y-6",onSubmit:D(k,["prevent"])},[t("div",B,[t("div",null,[e[8]||(e[8]=t("label",{for:"first_name",class:"block text-sm font-medium text-gray-700 mb-1"},"نام",-1)),n(t("input",{id:"first_name","onUpdate:modelValue":e[0]||(e[0]=o=>r.value.first_name=o),type:"text",class:"block w-full px-4 py-2.5 text-gray-700 bg-white border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-colors",required:""},null,512),[[p,r.value.first_name]])]),t("div",null,[e[9]||(e[9]=t("label",{for:"last_name",class:"block text-sm font-medium text-gray-700 mb-1"},"نام خانوادگی",-1)),n(t("input",{id:"last_name","onUpdate:modelValue":e[1]||(e[1]=o=>r.value.last_name=o),type:"text",class:"block w-full px-4 py-2.5 text-gray-700 bg-white border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-colors",required:""},null,512),[[p,r.value.last_name]])])]),t("div",N,[t("div",null,[e[10]||(e[10]=t("label",{for:"email",class:"block text-sm font-medium text-gray-700 mb-1"},"ایمیل",-1)),n(t("input",{id:"email","onUpdate:modelValue":e[2]||(e[2]=o=>r.value.email=o),type:"email",dir:"ltr",class:"block w-full px-4 py-2.5 text-gray-700 bg-white border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-colors",required:""},null,512),[[p,r.value.email]])]),t("div",null,[e[11]||(e[11]=t("label",{for:"phone",class:"block text-sm font-medium text-gray-700 mb-1"},"شماره موبایل",-1)),n(t("input",{id:"phone","onUpdate:modelValue":e[3]||(e[3]=o=>r.value.phone=o),type:"tel",class:"block w-full px-4 py-2.5 text-gray-700 bg-white border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-colors",required:""},null,512),[[p,r.value.phone]])])]),t("div",null,[e[13]||(e[13]=t("label",{for:"role",class:"block text-sm font-medium text-gray-700 mb-1"},"نقش",-1)),n(t("select",{id:"role","onUpdate:modelValue":e[4]||(e[4]=o=>r.value.role=o),class:"block w-full px-4 py-2.5 text-gray-700 bg-white border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-colors",required:""},e[12]||(e[12]=[t("option",{value:"admin"},"مدیر",-1),t("option",{value:"employee"},"کارمند",-1)]),512),[[g,r.value.role]])]),t("div",null,[e[15]||(e[15]=t("label",{for:"department_id",class:"block text-sm font-medium text-gray-700 mb-1"},"دپارتمان",-1)),n(t("select",{id:"department_id","onUpdate:modelValue":e[5]||(e[5]=o=>r.value.department_id=o),class:"block w-full px-4 py-2.5 text-gray-700 bg-white border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-colors",required:""},[e[14]||(e[14]=t("option",{value:""},"انتخاب دپارتمان",-1)),(a(!0),s(h,null,j(b.value,o=>(a(),s("option",{key:o.id,value:o.id},c(o.title),9,S))),128))],512),[[g,r.value.department_id]])]),t("div",C,[t("div",null,[e[16]||(e[16]=t("label",{for:"birthdate",class:"block text-sm font-medium text-gray-700 mb-1"},"تاریخ تولد",-1)),v(y(x),{id:"birthdate",modelValue:r.value.birthdate,"onUpdate:modelValue":e[6]||(e[6]=o=>r.value.birthdate=o),format:"YYYY-MM-DD","display-format":"jYYYY-jMM-jDD",editable:!1,"auto-submit":!1,"input-class":"block w-full px-4 py-2.5 text-gray-700 bg-white border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-colors"},null,8,["modelValue"])]),t("div",null,[e[17]||(e[17]=t("label",{for:"cooperation_start_date",class:"block text-sm font-medium text-gray-700 mb-1"},"تاریخ شروع همکاری",-1)),v(y(x),{id:"cooperation_start_date",modelValue:r.value.cooperation_start_date,"onUpdate:modelValue":e[7]||(e[7]=o=>r.value.cooperation_start_date=o),format:"YYYY-MM-DD","display-format":"jYYYY-jMM-jDD",editable:!1,"auto-submit":!1,"input-class":"block w-full px-4 py-2.5 text-gray-700 bg-white border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-colors"},null,8,["modelValue"])])]),t("div",F,[t("button",{type:"submit",class:"w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 transition-colors",disabled:l.value},[l.value?(a(),s("span",A)):(a(),s("span",E,"ثبت کاربر"))],8,T)]),i.value?(a(),s("div",L,c(i.value),1)):M("",!0)],32)])]))}};export{G as default};
