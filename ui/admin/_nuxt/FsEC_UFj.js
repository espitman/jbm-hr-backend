import{_ as C}from"./qQdQVG1-.js";import{j as k,k as V,r as u,C as B,o as a,w as U,a as e,d as M,t as x,c as d,n as _,v as w,b as h,m as S,y as L,q as A,F as H,B as N}from"./BJEvtXCT.js";import{_ as z}from"./DfrOUCg1.js";const F={class:"space-y-6"},T={class:"text-gray-700 text-center"},I={class:"font-bold"},G={class:"pt-2 flex gap-4"},J=["disabled"],K={key:0,class:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"},P={key:1},Q={__name:"DeleteAlbumModal",props:{isOpen:{type:Boolean,required:!0},image:{type:Object,required:!0}},emits:["close","success"],setup(b,{emit:y}){const{$api:m}=k(),p=b,r=y,o=V(),s=u(!1),i=()=>{r("close")},f=async()=>{try{s.value=!0,await m.delete(`/api/v1/admin/albums/${p.image.id}`),o.success("تصویر با موفقیت حذف شد"),r("success"),i()}catch(n){o.error("خطا در حذف تصویر"),console.error("Error deleting image:",n)}finally{s.value=!1}};return(n,t)=>(a(),B(C,{"is-open":b.isOpen,title:"حذف تصویر",size:"md","show-cancel-button":!1,"show-footer":!1,onClose:i},{default:U(()=>[e("div",F,[e("p",T,[t[0]||(t[0]=M(" آیا از حذف تصویر ")),e("span",I,x(b.image.caption),1),t[1]||(t[1]=M(" اطمینان دارید؟ "))]),e("div",G,[e("button",{onClick:f,class:"flex-[2] flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors",disabled:s.value},[s.value?(a(),d("span",K)):(a(),d("span",P,"حذف"))],8,J),e("button",{onClick:i,class:"flex-1 px-4 py-3 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors"}," انصراف ")])])]),_:1},8,["is-open"]))}},R={class:"flex justify-end"},W=["disabled"],X={key:0,class:"animate-spin rounded-full h-5 w-5 border-b-2 border-white inline-block"},Y={key:1},Z={__name:"AlbumUpload",emits:["success"],setup(b,{emit:y}){const{$api:m}=k(),p=V(),r=u(!1),o=u({caption:"",url:null}),s=y,i=t=>{o.value.url=t},f=async()=>{if(!(!o.value.url||!o.value.caption))try{r.value=!0,await m.post("/api/v1/admin/albums",{caption:o.value.caption,url:o.value.url}),p.success("تصویر با موفقیت آپلود شد"),s("success"),n()}catch(t){p.error("خطا در آپلود تصویر"),console.error("Error uploading image:",t)}finally{r.value=!1}},n=()=>{o.value={caption:"",url:null}};return(t,l)=>(a(),d("form",{onSubmit:S(f,["prevent"]),class:"space-y-4"},[e("div",null,[l[1]||(l[1]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"عنوان تصویر",-1)),_(e("input",{"onUpdate:modelValue":l[0]||(l[0]=$=>o.value.caption=$),type:"text",class:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500",required:""},null,512),[[w,o.value.caption]])]),e("div",null,[l[2]||(l[2]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"تصویر",-1)),h(z,{dir:"albums",onUploaded:i})]),e("div",R,[e("button",{type:"submit",class:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500",disabled:r.value},[r.value?(a(),d("span",X)):(a(),d("span",Y,"آپلود"))],8,W)])],32))}},ee={class:"space-y-2"},te={class:"space-y-2"},se={class:"flex justify-end gap-3 mt-6"},oe=["disabled"],le={key:0},ae={key:1},ne={__name:"EditAlbumModal",props:{modelValue:{type:Boolean,default:!1},album:{type:Object,default:()=>({})}},emits:["update:modelValue","updated"],setup(b,{emit:y}){const m=b,p=y,{$api:r}=k(),o=V(),s=u({caption:"",display_order:0,url:""}),i=u(!1),f=async()=>{try{i.value=!0,await r.put(`/api/v1/admin/albums/${m.album.id}`,s.value),o.success("آلبوم با موفقیت ویرایش شد"),p("updated"),p("update:modelValue",!1)}catch{o.error("خطایی در ویرایش آلبوم رخ داد")}finally{i.value=!1}};return L(()=>m.album,n=>{n&&(s.value={caption:n.caption||"",display_order:n.display_order||0,url:n.url||""})},{immediate:!0}),(n,t)=>(a(),B(C,{"is-open":b.modelValue,"show-cancel-button":!1,"show-footer":!1,title:"ویرایش آلبوم",onClose:t[4]||(t[4]=l=>n.$emit("update:modelValue",!1))},{default:U(()=>[e("form",{onSubmit:S(f,["prevent"]),class:"space-y-4"},[e("div",ee,[t[5]||(t[5]=e("label",{class:"block text-sm font-medium text-gray-700"},"عنوان",-1)),_(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>s.value.caption=l),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"عنوان آلبوم"},null,512),[[w,s.value.caption]])]),e("div",te,[t[6]||(t[6]=e("label",{class:"block text-sm font-medium text-gray-700"},"ترتیب نمایش",-1)),_(e("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>s.value.display_order=l),type:"number",class:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"ترتیب نمایش"},null,512),[[w,s.value.display_order,void 0,{number:!0}]])]),_(e("input",{type:"hidden","onUpdate:modelValue":t[2]||(t[2]=l=>s.value.url=l)},null,512),[[w,s.value.url]]),e("div",se,[e("button",{type:"button",class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md",onClick:t[3]||(t[3]=l=>n.$emit("update:modelValue",!1))}," انصراف "),e("button",{type:"submit",class:"px-4 py-2 text-sm font-medium text-white bg-purple-600 border border-transparent rounded-md",disabled:i.value},[i.value?(a(),d("span",le,"در حال ذخیره...")):(a(),d("span",ae,"ذخیره تغییرات"))],8,oe)])],32)]),_:1},8,["is-open"]))}},re={class:"container mx-auto p-1"},ie={key:0,class:"flex justify-center items-center h-64"},de={key:1,class:"text-center text-red-600 p-4 bg-red-50 rounded-lg"},ue={key:2,class:"text-center text-gray-500 p-8"},ce={key:3,class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6"},pe={class:"relative aspect-square"},me={class:"absolute top-2 left-2 bg-purple-600 text-white px-2 py-1 rounded-md text-sm font-medium"},fe=["src","alt"],ve={class:"absolute top-2 right-2 flex gap-2"},be=["onClick"],ge=["onClick"],ye={class:"p-4"},he={class:"text-sm text-gray-600"},ke={__name:"list",setup(b){const{$api:y}=k(),m=u([]),p=u(!0),r=u(null),o=u(!1),s=u(!1),i=u(!1),f=u(null),n=u(null),t=async()=>{try{p.value=!0,r.value=null;const g=await y.get("/api/v1/albums");m.value=g.data||[]}catch(g){r.value=g.message||"خطا در دریافت تصاویر"}finally{p.value=!1}},l=g=>{f.value=g,s.value=!0},$=()=>{s.value=!1,f.value=null},D=()=>{o.value=!0},j=()=>{o.value=!1},O=()=>{j(),t()},E=g=>{n.value=g,i.value=!0};return A(()=>{t()}),(g,c)=>(a(),d("div",re,[e("div",{class:"flex justify-between items-center mb-6"},[c[2]||(c[2]=e("h1",{class:"text-xl font-bold text-purple-700"},"آلبوم تصاویر",-1)),e("button",{onClick:D,class:"inline-flex items-center px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors duration-200"},c[1]||(c[1]=[e("svg",{class:"w-5 h-5 ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),M(" آپلود تصویر جدید ")]))]),p.value?(a(),d("div",ie,c[3]||(c[3]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"},null,-1)]))):r.value?(a(),d("div",de,x(r.value),1)):m.value.length===0?(a(),d("div",ue," هیچ تصویری یافت نشد ")):(a(),d("div",ce,[(a(!0),d(H,null,N(m.value,v=>(a(),d("div",{key:v.id,class:"bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow duration-200"},[e("div",pe,[e("div",me,x(v.display_order),1),e("img",{src:v.url,alt:v.caption,class:"w-full h-full object-cover"},null,8,fe),e("div",ve,[e("button",{onClick:q=>E(v),class:"p-2 bg-purple-600 text-white rounded-full hover:bg-purple-700 transition-colors duration-200"},c[4]||(c[4]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)]),8,be),e("button",{onClick:q=>l(v),class:"p-2 bg-red-600 text-white rounded-full hover:bg-red-700 transition-colors duration-200"},c[5]||(c[5]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,ge)])]),e("div",ye,[e("p",he,x(v.caption),1)])]))),128))])),h(C,{"is-open":o.value,title:"آپلود تصویر جدید",size:"lg","show-cancel-button":!1,"show-footer":!1,onClose:j},{default:U(()=>[h(Z,{onSuccess:O})]),_:1},8,["is-open"]),h(Q,{"is-open":s.value,image:f.value,onClose:$,onSuccess:t},null,8,["is-open","image"]),h(ne,{modelValue:i.value,"onUpdate:modelValue":c[0]||(c[0]=v=>i.value=v),album:n.value,onUpdated:t},null,8,["modelValue","album"])]))}};export{ke as default};
