import{g as b,r as d,B as y,c as r,o,x as k,l as x,y as U,a as s,d as B,F as I,m as M,v as N,t as v}from"./D_B6tzIL.js";const T={class:"relative"},$=["placeholder"],C={key:0,class:"absolute z-10 left-0 right-0 bg-white border border-gray-200 rounded-lg mt-1 shadow-lg max-h-60 overflow-auto"},F={key:0,class:"flex items-center gap-2 px-3 py-2 text-gray-500"},V=["onMousedown"],j=["src"],D={key:1,class:"w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center text-xs text-gray-500"},S={class:"flex flex-col"},z={class:"font-medium text-sm text-gray-800"},E={class:"text-xs text-gray-500"},A={__name:"UserFilter",props:{placeholder:{type:String,default:"جستجوی کاربر..."},selectedUser:{type:Object,default:null},defaultUserId:{type:[String,Number],default:""}},emits:["select"],setup(p,{emit:h}){const i=h,{$api:f}=b(),a=d(""),u=d([]),c=d(!1);let m;const n=d(!1);y(()=>p.selectedUser,e=>{e&&e.full_name?a.value=e.full_name:a.value=""},{immediate:!0}),y(()=>p.defaultUserId,async e=>{if(!e){a.value="",i("select",null);return}try{const t=await f.get(`/api/v1/admin/users/${e}`);t.data&&(a.value=t.data.first_name+" "+t.data.last_name,i("select",t.data))}catch{a.value="",i("select",null)}},{immediate:!0});const _=()=>{if(c.value=!0,m&&clearTimeout(m),!a.value){u.value=[],n.value=!1;return}n.value=!0,m=setTimeout(async()=>{try{const e=await f.get(`/api/v1/admin/users/search/${encodeURIComponent(a.value)}`);u.value=e.data.items||[],n.value=!1}catch{u.value=[],n.value=!1}},400)},w=e=>{i("select",e),a.value=e.full_name,c.value=!1};return document.addEventListener("click",()=>{c.value=!1}),(e,t)=>(o(),r("div",T,[k(s("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>a.value=l),class:"rounded-lg border border-gray-200 bg-white px-3 py-2 text-gray-700 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-200 focus:border-purple-300 transition w-full text-sm",type:"text",placeholder:p.placeholder,onFocus:t[1]||(t[1]=l=>c.value=!0),onInput:_},null,40,$),[[U,a.value]]),c.value&&(u.value.length>0||n.value)?(o(),r("ul",C,[n.value?(o(),r("li",F,t[2]||(t[2]=[s("svg",{class:"animate-spin h-4 w-4 mr-2 text-purple-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),s("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})],-1),B(" در حال جستجو... ")]))):x("",!0),(o(!0),r(I,null,M(u.value,l=>{var g;return o(),r("li",{key:l.id,class:"flex items-center gap-2 px-3 py-2 cursor-pointer hover:bg-purple-50",onMousedown:N(L=>w(l),["prevent"])},[l.avatar?(o(),r("img",{key:0,src:l.avatar,class:"w-8 h-8 rounded-full object-cover border border-gray-200",alt:"avatar"},null,8,j)):(o(),r("div",D,[s("span",null,v((g=l.full_name)==null?void 0:g.slice(0,1)),1)])),s("div",S,[s("span",z,v(l.full_name),1),s("span",E,v(l.department),1)])],40,V)}),128))])):x("",!0)]))}};export{A as _};
